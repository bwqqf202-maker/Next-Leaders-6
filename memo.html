<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STEF 展示会リスト (安定版)</title>
    <style>
        body { font-family: sans-serif; background: #f4f7f6; margin: 0; padding: 20px; color: #333; }
        .container { max-width: 1200px; margin: 0 auto; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        
        /* エラー表示用 */
        #errorBox { display: none; background: #ffe6e6; color: #d00; padding: 15px; margin-bottom: 20px; border: 1px solid #f00; border-radius: 4px; }
        
        h1 { margin-top: 0; font-size: 22px; }
        .stats-bar { background: #eef2f5; padding: 10px; border-radius: 6px; margin-bottom: 15px; font-weight: bold; color: #555; display: flex; justify-content: space-between; align-items: center;}

        /* ツールバー */
        .tools { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px; }
        input[type="text"] { flex-grow: 1; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 16px; }
        
        button { cursor: pointer; padding: 8px 16px; border: none; border-radius: 4px; font-weight: bold; color: #fff; font-size: 14px; }
        .btn-filter { background: #6c757d; color: #fff; opacity: 0.7; }
        .btn-filter.active { opacity: 1; background: #007bff; box-shadow: 0 2px 5px rgba(0,123,255,0.3); }
        .btn-csv { background: #28a745; }
        .btn-reset { background: #dc3545; }

        /* テーブル */
        .table-wrap { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; min-width: 800px; }
        th, td { border: 1px solid #eee; padding: 10px; vertical-align: top; }
        th { background: #f8f9fa; position: sticky; top: 0; text-align: left; color: #555; }
        
        /* 列幅 */
        .c-star { width: 40px; text-align: center; }
        .c-check { width: 40px; text-align: center; }
        .c-no { width: 70px; font-weight: bold; }
        .c-name { font-weight: bold; color: #0056b3; }
        .c-theme { font-size: 0.85em; color: #777; width: 15%; }
        
        /* 行スタイル */
        tr.visited { background: #e6ffe6; }
        tr.visited td { color: #888; }
        tr.visited .c-name { color: #666; text-decoration: line-through; }
        
        /* ★ボタン */
        .star { font-size: 22px; cursor: pointer; color: #ccc; background: none; border: none; padding: 0; }
        .star.on { color: #ffc107; text-shadow: 0 1px 2px rgba(0,0,0,0.2); }

        /* メモ */
        textarea { width: 100%; height: 50px; border: 1px solid #ddd; border-radius: 4px; resize: vertical; padding: 5px; font-family: inherit; }
        textarea:focus { border-color: #007bff; outline: none; }
    </style>
</head>
<body>

<div class="container">
    <div id="errorBox"></div>

    <h1>STEF 展示会リスト Pro</h1>
    
    <div class="stats-bar">
        <span id="progressText">読込中...</span>
        <button class="btn-reset" onclick="fullReset()">⚠ 強制リセット</button>
    </div>

    <div class="tools">
        <input type="text" id="searchInput" placeholder="検索: AI, センサー, No..." onkeyup="render()">
        <button class="btn-filter active" onclick="setMode('all', this)">全て</button>
        <button class="btn-filter" onclick="setMode('star', this)">★候補</button>
        <button class="btn-filter" onclick="setMode('unvisited', this)">未訪問</button>
        <button class="btn-csv" onclick="exportCSV()">CSV保存</button>
    </div>

    <div class="table-wrap">
        <table id="listTable">
            <thead>
                <tr>
                    <th class="c-star">★</th>
                    <th class="c-check">済</th>
                    <th class="c-no">No.</th>
                    <th class="c-name">出展名 / 概要</th>
                    <th class="c-theme">テーマ</th>
                    <th>メモ</th>
                </tr>
            </thead>
            <tbody id="tbody"></tbody>
        </table>
    </div>
</div>

<script>
    // エラーハンドリング（万が一用）
    window.onerror = function(msg, url, line) {
        const box = document.getElementById('errorBox');
        box.style.display = 'block';
        box.innerHTML = `<strong>エラーが発生しました:</strong><br>${msg}<br>Line: ${line}<br>「強制リセット」ボタンを押してみてください。`;
    };

    // ▼ データ定義 ▼
    const DB = [
        {no: "No.01", name: "XYN 空間コンテンツ制作ソリューションと関連技術", summary: "効率的に超高精細・フォトリアルな空間コンテンツを制作", theme: "Creative Entertainment Vision"},
        {no: "No.02", name: "リハビリゲーム", summary: "コントローラー不要で楽しめるゲーミフィケーション", theme: "多様な事業の成長"},
        {no: "No.03", name: "エンタテインメント向け群ロボット", summary: "群ロボットと演者や観客との協調動作が生む新たなステージ体験", theme: "Creative Entertainment Vision"},
        {no: "No.04", name: "Creation with Search, Generation and Separation", summary: "映像、音、テキストを用いた直感的なアセット検索・効果音生成・音源分離", theme: "Creative Entertainment Vision"},
        {no: "No.05", name: "4D Capture Technology", summary: "シングルカメラで動きも形状もリアルに撮影", theme: "Creative Entertainment Vision"},
        {no: "No.06", name: "Interactive Music UX for Performers", summary: "アーティストやダンサーなど多様なパフォーマーのためのインタラクティブな演奏・鑑賞体験のための技術", theme: "Creative Entertainment Vision"},
        {no: "No.07", name: "Creator Economy", summary: "ブロックチェーンが高める作品の価値", theme: "Creative Entertainment Vision"},
        {no: "No.08", name: "Emotion Estimation", summary: "脳波による情動推定でコンテンツ体験中のユーザー反応を評価", theme: "Creative Entertainment Vision"},
        {no: "No.09", name: "Electric Stabilizer Cam", summary: "迫力の主観視点をリアルタイム伝送", theme: "Creative Entertainment Vision"},
        {no: "No.10", name: "Immersive Music Hapitcs Chair", summary: "身体が楽器となり、音楽と一体化する新体験", theme: "Creative Entertainment Vision"},
        {no: "No.11", name: "Sony Bank CONNECT 2025", summary: "デジタル資産の所有による新たな体験と価値", theme: "Creative Entertainment Vision"},
        {no: "No.12", name: "Wwise Similar Sound Search", summary: "大規模オーディオコレクションから目的とする音源を直感的に検索", theme: "Creative Entertainment Vision"},
        {no: "No.13", name: "Sensory Re:Fusion for LBE", summary: "視覚、聴覚、嗅覚、触覚を刺激する没入型体験", theme: "Creative Entertainment Vision"},
        {no: "No.14", name: "Beyond HDR", summary: "リアルな光の煌めきを映し出す", theme: "Creative Entertainment Vision"},
        {no: "No.15", name: "Advanced Super Resolution", summary: "あらゆるコンテンツを超解像で鮮明に", theme: "Creative Entertainment Vision"},
        {no: "No.16", name: "Feel So Music", summary: "音楽に触れる驚きが、心震わせる", theme: "Creative Entertainment Vision"},
        {no: "No.17", name: "Virtual Theater + 360 Virtual Mixing Environment (360VME)", summary: "シアターの音と画をリモート環境で再現。高精度な空間音響確認作業がいつでも可能に。", theme: "Creative Entertainment Vision"},
        {no: "No.18", name: "Location Based Entertainment SDK", summary: "デバイス装着不要のインタラクティブな没入体験", theme: "Creative Entertainment Vision"},
        {no: "No.18 PCL", name: "多感覚イマーシブ体験、LBE SDK、VR", summary: "ソニーの多感覚技術（映像・音響・触覚・におい・風）を統合して構築した、五感で感じる没入型XR体験。", theme: "Creative Entertainment Vision"},
        {no: "No.19", name: "音のXR体験", summary: "インタラクティブゲームサウンドエンジンでつくる立体音響ソリューション", theme: "Creative Entertainment Vision"},
        {no: "E-01", name: "Gaze-based user-content interaction", summary: "視線情報に基づいた、ユーザーとコンテンツの新しいインタラクション", theme: "Creative Entertainment Vision"},
        {no: "E-02", name: "AIコメンタリー生成", summary: "実況・解説・速報・記事を自動生成し、データを即座にコンテンツ化", theme: "Creative Entertainment Vision"},
        {no: "E-03", name: "Sports Fan Engagement", summary: "スポーツIPを活用した新たなファンエンゲージメントサービス", theme: "Creative Entertainment Vision"},
        {no: "E-04", name: "PRISM", summary: "AI-powered suite for creating digital artifacts like descriptions, subtitles, videos & images enhancing content discovery", theme: "Creative Entertainment Vision"},
        {no: "E-05", name: "On-set VFX Creation", summary: "空間センシング（デプスセンシング・カメラトラッキング）でVFX映像制作クリエーションを加速", theme: "Creative Entertainment Vision"},
        {no: "E-06", name: "Force & Touch LBE", summary: "自在な力提示×力触覚センシングで、LBEに新しい体験を創出", theme: "Creative Entertainment Vision"},
        {no: "E-07", name: "実世界行動支援プラットフォーム", summary: "行動履歴・空間情報と連携したAIによりコンテンツ制作や日常行動をリアルタイムに支援", theme: "Creative Entertainment Vision"},
        {no: "E-08", name: "MIMoSA", summary: "AIが作業効率を高め、クリエイターが創造的な制作に没頭できる3DCG映像制作ツール", theme: "Creative Entertainment Vision"},
        {no: "E-09", name: "3D ハプティック デバイス", summary: "3D仮想オブジェクトに直接インタラクションするハプティックシミュレーター", theme: "多様な事業の成長"},
        {no: "E-10", name: "Podcast Video Studio", summary: "Low-cost Podcast Video Studio solution for Sony Alpha/Cinema-Line/SDK cameras", theme: "Creative Entertainment Vision"},
        {no: "E-11", name: "Tanuki: Robotic Craftsman’s Assistant", summary: "Scalable End-effector Platform for Fine Manipulation in Craftsmanship", theme: "Creative Entertainment Vision"},
        {no: "E-12", name: "In-Camera Apps", summary: "撮影現場を「制約との戦い」から開放し「純粋なクリエイティブワーク」に変革する", theme: "多様な事業の成長"},
        {no: "E-13", name: "Immersive 3D experience for multiple viewers", summary: "安価で軽量な偏光メガネをかけるだけで複数人での高品位な3D映像体験を可能にする技術", theme: "多様な事業の成長"},
        {no: "E-14", name: "Reimagine. Reinvent. Recreate—with AI", summary: "DeepTech solution for entertainment business helps creators & marketers craft localized content", theme: "Creative Entertainment Vision"},
        {no: "E-15", name: "Creative Agent Hub", summary: "あなたも今日からクリエイター！エッジデバイスに話しかけるだけで様々な機器を制御できるAIフレームワーク技術", theme: "Creative Entertainment Vision"},
        {no: "E-16", name: "Sony Financial Group × Technologies", summary: "ソニーフィナンシャルグループの成長を支援する技術群", theme: "多様な事業の成長"},
        {no: "E-17", name: "CATSeye", summary: "A precision sensor for verifying playback fidelity of multimedia on physical displays.", theme: "Creative Entertainment Vision"},
        {no: "E-18", name: "光学シースルーARグラス向け超低遅延6DoFヘッドトラッキング", summary: "センサとディスプレイを連動させ超低遅延で高精度な6DoFヘッドトラッキングエコシステムを構築", theme: "Creative Entertainment Vision"},
        {no: "E-19", name: "キャプチャからクリエーション迄sVisionが実現する世界", summary: "sVisionによるキャプチャからクリエーション迄のオールインワンコンテンツクリエーション", theme: "Creative Entertainment Vision"},
        {no: "E-20", name: "One Shot LOFIC Vision", summary: "世界最小画素で、あらゆるシーンを1回の撮影で映し出すHDRセンサー技術", theme: "Creative Entertainment Vision"},
        {no: "E-21", name: "4D イマーシブコンテンツクリエーション", summary: "先端AIによるフォトリアルな3DCGと物理シミュレーションが融合する未来の4Dコンテンツ制作技術", theme: "Creative Entertainment Vision"},
        {no: "FO-01", name: "Location-based Digital-Twin World", summary: "位置センシング技術を用いたエンタメ空間の3D可視化とAIエージェントによるフィードバック", theme: "Creative Entertainment Vision"},
        {no: "FO-02", name: "Origanoid：オリガノイド", summary: "数ミクロン精度の精密操作ができる手のひらサイズな次世代医療用の折り紙ロボット技術", theme: "多様な事業の成長"},
        {no: "FO-03", name: "AIロボティクスを用いたエンタメフィットネスソリューション", summary: "ユーザーの動きとバーチャルな演出に合わせ、リアルタイムに物理負荷を制御するAIロボティクスシステム", theme: "多様な事業の成長"},
        {no: "G-01", name: "AI Gameplay Helper", summary: "ゲームプレイにおける困りごとを解決するAI Agentを実現する技術", theme: "Creative Entertainment Vision"},
        {no: "G-02", name: "Gen-NSA", summary: "AI-based video processing system that enhances video streaming quality for cloud gaming", theme: "Creative Entertainment Vision"},
        {no: "G-03", name: "Autonomous Agents", summary: "Autonomous agents that learn to master gameplay through machine learning", theme: "多様な事業の成長"},
        {no: "G-04", name: "Peregrine", summary: "Impossibly fast high-quality texture compression for videogames and real-time graphics", theme: "Creative Entertainment Vision"},
        {no: "G-05", name: "True 3D Holo", summary: "デジタルコンテンツが現実世界と融合できて、裸眼で見える、高精細ホログラム映像", theme: "Creative Entertainment Vision"},
        {no: "G-06", name: "VolumetricShot", summary: "2Dスクリーンショットを3Dに進化させ、あとから追体験できるキャプチャ技術", theme: "Creative Entertainment Vision"},
        {no: "G-07", name: "FanEngage AI Agent", summary: "マーケティング・顧客理解・分析 — ファン・エンゲージメントを実現するAI Agent技術", theme: "多様な事業の成長"},
        {no: "I-01", name: "Gaze Control System", summary: "高速移動物体にズームイン、追従し続けるカメラシステムと、そのスポーツへの応用", theme: "Creative Entertainment Vision"},
        {no: "I-02", name: "Vision AI Unplugged", summary: "Battery powered camera with edge AI to detect office occupancy", theme: "多様な事業の成長"},
        {no: "I-03", name: "Twin Lib & Scan-to-Plan SW platforms", summary: "Platform to transform Manually and with AI any 3D Scanned Point-Cloud data into a 2D Floorplan", theme: "多様な事業の成長"},
        {no: "I-04", name: "Fregata", summary: "モバイル/XRデバイスの自律制御により快適なユーザー体験を提供する、超低電力AI認識イメージセンサ", theme: "Creative Entertainment Vision"},
        {no: "I-05", name: "RoboOps Next as Data Platform", summary: "Our DataOps platform makes it easy to collect RGB‑D data and annotate it semi‑automatically.", theme: "多様な事業の成長"},
        {no: "I-06", name: "Vision for All", summary: "Showcasing smart edge-cloud Vision AI tools that democratize capabilities for all user", theme: "多様な事業の成長"},
        {no: "I-07", name: "RGB Saving lives", summary: "SONY RGB sensor pre certified for Industrial Functional Safety", theme: "多様な事業の成長"},
        {no: "I-08", name: "Sense Anytime", summary: "AI-based Imaging & Sensing pipeline optimization", theme: "多様な事業の成長"},
        {no: "M-01", name: "インタラクティブAIアーティスト", summary: "観客の反応にリアルタイムで応答する自律型AIアーティスト音楽ライブ", theme: "Creative Entertainment Vision"},
        {no: "M-02", name: "コンテンツセキュリティ / ウォーターマーク", summary: "コンテンツ不正流出・利用の被害からエンタメ事業を護るセキュリティ技術", theme: "Creative Entertainment Vision"},
        {no: "M-03", name: "リアルとバーチャルの境界を超える音", summary: "聴覚と情動のメカニズムを解明しクリエイションに貢献する電戦音質WG活動", theme: "Creative Entertainment Vision"},
        {no: "M-04", name: "3D サラウンド パンナー", summary: "PS5コントローラーを用いた3Dサラウンドパンナーシステム", theme: "Creative Entertainment Vision"},
        {no: "M-05", name: "AI Ethics", summary: "Gen AI Toolkit, Prompt Probe, FHIBE (Ethical risks, IP infringement, bias checks)", theme: "多様な事業の成長"},
        {no: "P-01", name: "AI Translation & Dubbing", summary: "AI-powered automatic Dubbing & Other Entertainment technology", theme: "Creative Entertainment Vision"},
        {no: "P-02", name: "ACE", summary: "アニメで「いつ」「誰が」「何を」話しているかを自動で推定する技術", theme: "Creative Entertainment Vision"},
        {no: "P-03", name: "マルチレイヤーモノポールシンセシス", summary: "卓越した空間表現力を可能にするレイヤー構造を持つ音響信号処理技術", theme: "Creative Entertainment Vision"},
        {no: "P-04", name: "AIDE for Content", summary: "AIを活用したストーリーライン強化や、長編ビデオからの短編動画自動作成", theme: "多様な事業の成長"},
        {no: "P-05", name: "デジタルツインクリエイション", summary: "リアルとフィクションをつなぐ3Dワールド生成技術", theme: "Creative Entertainment Vision"},
        {no: "P-06", name: "AutoDailies", summary: "Automate sync and color tasks, empowering teams to deliver faster dailies for film & TV", theme: "Creative Entertainment Vision"},
        {no: "P-07", name: "Micro-budget Diffusion Model", summary: "Text-to-image diffusion model MicroDiT with 14x lower cost", theme: "Creative Entertainment Vision"},
        {no: "Online", name: "DaVinci", summary: "Compact RGB-D system specifically designed for XR glasses integrating RGB, dToF and intelligence", theme: "Creative Entertainment Vision"},
        {no: "Online", name: "Lag Less Streaming", summary: "生成AIを用いてクラウドゲーミングのレイテンシ補償を行う技術", theme: "Creative Entertainment Vision"},
        {no: "Online", name: "Lillian Tactile VR", summary: "Explore real surface interaction in VR using depthsensing", theme: "Creative Entertainment Vision"},
        {no: "Online", name: "コンテンツ制作を支えるプロ用音響機器のものづくりの進化", summary: "様々な特性を持つ社員が活躍できる現場を実現する機能補完技術", theme: "多様な事業の成長"},
        {no: "Online", name: "Dynamic Retrieval Augmented Generation", summary: "Open-source vector database enabling multi-modal AI search with simple UI and APIs", theme: "多様な事業の成長"},
        {no: "Online", name: "Digital Manga", summary: "Embeds invisible watermark to protect and track static content", theme: "Creative Entertainment Vision"},
        {no: "Online", name: "Similarity Search", summary: "Natural language search tool for visual and audio assets using vector index", theme: "Creative Entertainment Vision"},
        {no: "Online", name: "Project Orochi", summary: "A new flexible transmedia real-time technology platform", theme: "Creative Entertainment Vision"},
        {no: "Online", name: "TWS向けノイズキャンセル進化", summary: "TWS向けの適応型ノイズキャンセリングによる個人最適化", theme: "多様な事業の成長"},
        {no: "Online＆Poster", name: "アクチュエーターと触覚技術", summary: "複数技術領域に跨る統合的なメカトロニクス設計で実現するアクチュエーター技術と触覚技術", theme: "Creative Entertainment Vision"},
        {no: "Online＆Poster", name: "Eyeris", summary: "イメージセンサ設計を加速させる光学シミュレーションプラットフォーム", theme: "多様な事業の成長"},
        {no: "Online＆Poster", name: "ATHENA", summary: "XRリアルタイムVFX ～シネマカメラシステム・立体音響を活用した空間映像制作ワークフロー～", theme: "Creative Entertainment Vision"},
        {no: "Online＆Poster", name: "RecSys for SEP", summary: "Beyond traditional recommenders: solve cold starts, de-risk model updates", theme: "Creative Entertainment Vision"},
        {no: "Online＆Poster", name: "EMIフリーアーキテクチャ", summary: "追加部品不要！世界が認めるICでのEMI対策技術", theme: "多様な事業の成長"},
        {no: "Online＆Poster", name: "業界最高水準の特性を持つGSイメージセンサ", summary: "動きも細部も、正確に鮮やかに捉えるイメージセンサ技術", theme: "多様な事業の成長"},
        {no: "Online＆Poster", name: "インキャビンRGB → NIR AIモデル", summary: "IMX775 RGB/NIR センサによる車内タスクのためのRGB→近赤外線AIモデル", theme: "多様な事業の成長"},
        {no: "Online＆Poster", name: "RGB-D キャプチャツール", summary: "実世界データセットを作成するためのモバイルRGB-Dキャプチャツールと手順", theme: "Creative Entertainment Vision"},
        {no: "Online＆Poster", name: "プログラマブルLiDAR", summary: "測距仕様を自由に可変でき、多種多様な用途や製品に柔軟に対応できる画期的なLiDAR", theme: "多様な事業の成長"},
        {no: "Online＆Poster", name: "Climate Station", summary: "Immersive climate education through interactive storytelling", theme: "Creative Entertainment Vision"},
        {no: "Online＆Poster", name: "Sony Human Initiative", summary: "Framework of tools designed to streamline & define the next generation of character creation", theme: "Creative Entertainment Vision"},
        {no: "Online＆Poster", name: "超汎用IoTシステム", summary: "モニタ画像を利用し装置情報のデジタル化/人作業の自動記録/自動操作を行うIoTシステム", theme: "多様な事業の成長"},
        {no: "Online＆Poster", name: "Watch Me Play", summary: "Playtainment-Bringing Game contents on to OTT platforms", theme: "多様な事業の成長"},
        {no: "Online＆Poster", name: "生成AIによるソフトウエア単体テスト自動生成システム", summary: "手直し不要の単体テスト自動生成システムでソフトウエアエンジニアの付帯作業を削減", theme: "多様な事業の成長"},
        {no: "Online＆Poster", name: "デジタルツインラーニング", summary: "実世界と仮想環境を活用することで、自動運転AIなどのPhysical AI開発の効率改善と性能向上を実現する技術", theme: "多様な事業の成長"},
        {no: "Online＆Poster", name: "Sense beyond", summary: "距離だけでなく速度・振動などの動きをセンシング可能にする新たなソリューション", theme: "Creative Entertainment Vision"},
        {no: "Online＆Poster", name: "Face Image Enhancement", summary: "Advanced facial rendering enhancement technologies for Digital Human", theme: "Creative Entertainment Vision"},
        {no: "Online＆Poster", name: "AI Cost-Estimation System", summary: "調達部品のコスト試算・コストシミュレーションをAIで実現", theme: "多様な事業の成長"},
        {no: "Online＆Poster", name: "AIdeal", summary: "多目的最適化による創造支援ツール AIdeal", theme: "多様な事業の成長"},
        {no: "Online＆Poster", name: "StoryQuest", summary: "A conversational discovery engine that finds stories tailored to viewer's interest", theme: "Creative Entertainment Vision"},
        {no: "Online＆Poster", name: "Hardware Wallet as a Service", summary: "Security and Privacy Tech for Web3 and Digital Identity Service Providers", theme: "多様な事業の成長"},
        {no: "Online＆Poster", name: "AI-powered personalized CS Chatbot", summary: "生成 AI によるパーソナライズされた Chatbot", theme: "多様な事業の成長"},
        {no: "CA-1", name: "ポリネーターネットワーク", summary: "社員の専門性とクリエイティビティをつなぎ、コラボレーション＆イノベーションの活性化を支援するプログラム", theme: "Creative Entertainment Vision"},
        {no: "CA-2", name: "AIを活用した人と知識の動的結合による組織知活用技術", summary: "AIが組織内の知識と専門家情報を統合管理し、有識者への代理質問機能等により組織知の効率的活用を実現する技術", theme: "多様な事業の成長"}
    ];

    // ▼ アプリロジック ▼
    // 保存キーを更新して、過去の破損データから分離
    const KEY = 'stef_v5_final'; 
    let appState = {};
    let currentMode = 'all';

    function init() {
        try {
            // ロード
            const json = localStorage.getItem(KEY);
            if (json) {
                appState = JSON.parse(json);
            }
        } catch (e) {
            console.error(e);
            appState = {};
        }
        render();
    }

    function rend