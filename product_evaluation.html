<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã€ç·¨é›†å¯èƒ½ã€‘ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã‚¢ã‚¤ãƒ‡ã‚¢è©•ä¾¡ã‚·ãƒ¼ãƒˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
        }
        .tab-btn.active {
            border-color: #3b82f6;
            background-color: #3b82f6;
            color: white;
        }
        .content-box { display: none; }
        .content-box.active { display: block; }
        [contenteditable="true"] {
            outline: 2px solid transparent;
            transition: outline 0.2s;
            padding: 2px 4px;
            border-radius: 4px;
        }
        [contenteditable="true"]:hover {
            background-color: #eff6ff;
        }
        [contenteditable="true"]:focus {
            outline: 2px solid #3b82f6;
            background-color: white;
            box-shadow: 0 0 0 2px #bfdbfe;
        }
        @media (max-width: 768px) {
            .responsive-table thead { display: none; }
            .responsive-table, .responsive-table tbody, .responsive-table tr, .responsive-table td {
                display: block;
                width: 100%;
            }
            .responsive-table tr {
                margin-bottom: 1.5rem;
                border: 1px solid #e5e7eb;
                border-radius: 0.5rem;
                padding: 1rem;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
            .responsive-table td {
                padding-left: 50%;
                position: relative;
                text-align: right;
                border: none;
            }
            .responsive-table td::before {
                content: attr(data-label);
                position: absolute;
                left: 0.75rem;
                width: 45%;
                padding-right: 0.75rem;
                text-align: left;
                font-weight: 600;
                color: #1f2937;
            }
        }
        .rank-gold { background-color: #fffbeb; border-left-color: #f59e0b; }
        .rank-silver { background-color: #f9fafb; border-left-color: #9ca3af; }
        .rank-bronze { background-color: #fdf2f2; border-left-color: #cd7f32; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div class="container mx-auto p-4 sm:p-6 md:p-8">
        <header class="text-center mb-6">
            <h1 class="text-3xl md:text-4xl font-bold text-slate-900">ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã‚¢ã‚¤ãƒ‡ã‚¢è©•ä¾¡ã‚·ãƒ¼ãƒˆ</h1>
            <p class="mt-2 text-slate-600">ã‚¢ã‚¤ãƒ‡ã‚¢åã‚„ç‚¹æ•°ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç›´æ¥ç·¨é›†ã§ãã¾ã™ã€‚</p>
        </header>

        <div class="bg-white p-4 rounded-lg shadow-sm border border-slate-200 mb-6 flex flex-col sm:flex-row justify-center items-center gap-4">
            <button id="save-data" class="w-full sm:w-auto bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition">
                âœ”ï¸ ç·¨é›†ã‚’ä¿å­˜
            </button>
            <button id="reset-data" class="w-full sm:w-auto bg-slate-200 text-slate-700 font-bold py-2 px-6 rounded-lg hover:bg-slate-300 transition">
                ğŸ”„ åˆæœŸãƒ‡ãƒ¼ã‚¿ã«æˆ»ã™
            </button>
            <span id="save-status" class="text-sm text-slate-500 h-4"></span>
        </div>

        <nav class="flex justify-center border-b border-slate-200 mb-8">
            <button class="tab-btn active text-lg font-semibold py-3 px-6 border-b-4" data-tab="ideas">ã‚¢ã‚¤ãƒ‡ã‚¢ä¸€è¦§</button>
            <button class="tab-btn text-lg font-semibold py-3 px-6 border-b-4 border-transparent text-slate-500 hover:border-slate-300" data-tab="scoring">æ¡ç‚¹è¡¨</button>
            <button class="tab-btn text-lg font-semibold py-3 px-6 border-b-4 border-transparent text-slate-500 hover:border-slate-300" data-tab="criteria">æ¡ç‚¹åŸºæº–</button>
        </nav>

        <main id="data-container">
            <section id="ideas" class="content-box active space-y-6">
                </section>
            <section id="scoring" class="content-box">
                 <div class="overflow-x-auto bg-white rounded-lg shadow-sm border border-slate-200">
                    <table class="responsive-table w-full text-sm text-left">
                        <thead class="bg-slate-100 text-slate-600 uppercase">
                            <tr>
                                <th class="p-4">No</th><th class="p-4">ã‚¢ã‚¤ãƒ‡ã‚¢å</th><th class="p-4">å¸‚å ´æ€§</th><th class="p-4">åç›Šæ€§</th><th class="p-4">ã‚½ãƒ‹ãƒ¼ã‚‰ã—ã•</th><th class="p-4">æŠ€è¡“å®Ÿç¾æ€§</th><th class="p-4">ä»®èª¬æ¤œè¨¼å®¹æ˜“ã•</th><th class="p-4">Why Now</th><th class="p-4 font-bold">åˆè¨ˆç‚¹</th><th class="p-4 font-bold">é †ä½</th>
                            </tr>
                        </thead>
                        <tbody>
                            </tbody>
                    </table>
                </div>
            </section>
            <section id="criteria" class="content-box">
                </section>
        </main>
        
        <div class="mt-8 flex justify-center">
            <button id="add-idea" class="bg-green-500 text-white font-bold py-3 px-8 rounded-lg hover:bg-green-600 transition shadow">
                ï¼‹ æ–°ã—ã„ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’è¿½åŠ 
            </button>
        </div>

        <footer class="mt-8 text-center text-sm text-slate-500">
             <a href="index.html" class="text-blue-600 hover:underline">â† ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a>
        </footer>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const tabs = document.querySelectorAll('.tab-btn');
        const contents = document.querySelectorAll('.content-box');
        const saveDataBtn = document.getElementById('save-data');
        const resetDataBtn = document.getElementById('reset-data');
        const addIdeaBtn = document.getElementById('add-idea');
        const saveStatus = document.getElementById('save-status');
        const ideasSection = document.getElementById('ideas');
        const scoringTbody = document.querySelector('#scoring tbody');
        const criteriaSection = document.getElementById('criteria');
        const storageKey = 'productEvaluationData';

        const initialData = {
            // This is the initial data. It will be used if there's nothing in localStorage.
            // In the final version, this will be replaced with your data from the CSV.
            'A': { id: 'A', name: 'A. ç”»é¢ã‚¿ãƒƒãƒã§éŸ³æ¥½ã‚’å¥ã§ã‚‹ãƒ‡ãƒã‚¤ã‚¹', target: 'éŸ³æ¥½çµŒé¨“ã¯ãªã„ãŒã€æ‰‹è»½ã«è‡ªå·±è¡¨ç¾ã‚’ã—ãŸã„è‹¥è€…', problem: 'æ¥½å™¨æ¼”å¥ã¯ç¿’å¾—ãŒé›£ã—ãã€ä½œæ›²ã¯å°‚é–€çŸ¥è­˜ãŒå¿…è¦ã§ãƒãƒ¼ãƒ‰ãƒ«ãŒé«˜ã„', uvp: 'æ¥½è­œã‚‚çµŒé¨“ã‚‚ä¸è¦ã€‚è§¦ã‚Œã‚‹ã ã‘ã§ã€ãƒ—ãƒ­ãŒä½œã£ãŸã‚ˆã†ãªéŸ³æ¥½ã‚’ç›´æ„Ÿçš„ã«ç”Ÿã¿å‡ºã›ã‚‹é­”æ³•ã®ã‚­ãƒ£ãƒ³ãƒã‚¹', solution: 'ç”»é¢ã‚’ã‚¿ãƒƒãƒã™ã‚‹å ´æ‰€ã‚„æŒ‡ã®å‹•ãã§éŸ³è‰²ã‚„ãƒªã‚ºãƒ ãŒå¤‰åŒ–ã™ã‚‹ãƒ‘ãƒƒãƒ‰å‹ãƒ‡ãƒã‚¤ã‚¹ã€‚AIãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ“ä½œã‚’è§£æã—ã€éŸ³æ¥½çš„ã«ç ´ç¶»ã—ãªã„ã‚ˆã†ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ã‚¢ã‚·ã‚¹ãƒˆã™ã‚‹ã€‚', metrics: '1æ—¥ã‚ãŸã‚Šã®å¹³å‡æ¼”å¥æ™‚é–“ã€SNSã§ã®ä½œå“ã‚·ã‚§ã‚¢æ•°', tech: 'è§¦è¦šãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æŠ€è¡“ã€éŸ³æºåˆæˆæŠ€è¡“ã€AIã«ã‚ˆã‚‹éŸ³æ¥½ç”Ÿæˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ', score_market: 4, score_profit: 4, score_sony: 5, score_feasibility: 4, score_validation: 5, score_timing: 5 },
            'B': { id: 'B', name: 'B. å­ä¾›ã®æˆé•·ã‚’è¨˜éŒ²ã—ã€æ‰èƒ½ã‚’äºˆæ¸¬ã™ã‚‹AIã‚«ãƒ¡ãƒ©', target: 'å­ä¾›ã®å°†æ¥ã‚„æ•™è‚²ã«é–¢å¿ƒãŒé«˜ã„30-40ä»£ã®è¦ª', problem: 'å­ä¾›ã®ä½•æ°—ãªã„æ—¥å¸¸ã®è¡Œå‹•ã«ã©ã‚“ãªæ‰èƒ½ãŒéš ã‚Œã¦ã„ã‚‹ã‹åˆ†ã‹ã‚‰ãšã€æ•™è‚²æ–¹é‡ã«è¿·ã†', uvp: 'æ—¥å¸¸ã‚’æ’®ã‚‹ã ã‘ã§ã€AIãŒæˆ‘ãŒå­ã®ã€Œéš ã‚ŒãŸå¾—æ„ã€ã‚’è¦‹ã¤ã‘å‡ºã—ã€æœªæ¥ã®å¯èƒ½æ€§ã‚’æ•™ãˆã¦ãã‚Œã‚‹å­è‚²ã¦ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼', solution: 'å­ä¾›ã®è¡Œå‹•ï¼ˆãƒ–ãƒ­ãƒƒã‚¯éŠã³ã€çµµæãã€é‹å‹•ãªã©ï¼‰ã‚’å®šç‚¹ã‚«ãƒ¡ãƒ©ã§æ’®å½±ã€‚AIãŒç”»åƒè§£æã§è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åˆ†é¡ãƒ»åˆ†æã—ã€ã€Œç©ºé–“èªè­˜èƒ½åŠ›ãŒé«˜ã„ã€ã€Œé›†ä¸­åŠ›ãŒæŒç¶šã™ã‚‹ã€ãªã©ã®ç‰¹æ€§ã‚’å¯è¦–åŒ–ã—ã€ãƒ¬ãƒãƒ¼ãƒˆã™ã‚‹ã€‚', metrics: 'ä¿è­·è€…ã®ã‚¢ãƒ—ãƒªç¶™ç¶šåˆ©ç”¨ç‡ã€æœ‰æ–™ãƒ¬ãƒãƒ¼ãƒˆã®è³¼å…¥ç‡', tech: 'é«˜åº¦ãªç”»åƒèªè­˜ãƒ»è¡Œå‹•åˆ†æAIã€æ•™è‚²å¿ƒç†å­¦ã«åŸºã¥ã„ãŸåˆ†æãƒ¢ãƒ‡ãƒ«', score_market: 5, score_profit: 3, score_sony: 4, score_feasibility: 4, score_validation: 3, score_timing: 4 },
            'C': { id: 'C', name: 'C. æ²¡å…¥æ„Ÿã‚’ç©¶æ¥µã«é«˜ã‚ã‚‹VRãƒ©ã‚¤ãƒ–ç”¨ãƒ˜ãƒƒãƒ‰ã‚»ãƒƒãƒˆ', target: 'é æ–¹ã«ä½ã‚“ã§ã„ã‚‹ã€ã¾ãŸã¯ãƒã‚±ãƒƒãƒˆãŒå…¥æ‰‹å›°é›£ã§ãƒ©ã‚¤ãƒ–ã«è¡Œã‘ãªã„éŸ³æ¥½ãƒ•ã‚¡ãƒ³', problem: 'ãƒ©ã‚¤ãƒ–é…ä¿¡ã¯ä¾¿åˆ©ã ãŒã€ä¼šå ´ã®ç†±æ°—ã‚„ä¸€ä½“æ„ŸãŒãªãç‰©è¶³ã‚Šãªã„', uvp: 'è‡ªå®…ãŒæœ€å‰åˆ—ã‚¢ãƒªãƒ¼ãƒŠã«å¤‰ã‚ã‚‹ã€‚ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆã®æ¯é£ã„ã¨ä¼šå ´ã®ç†±ç‹‚ã‚’å…¨èº«ã§æ„Ÿã˜ã‚‹ã€ç©¶æ¥µã®æ²¡å…¥å‹ãƒ©ã‚¤ãƒ–ä½“é¨“', solution: '8Kè¶…é«˜è§£åƒåº¦æ˜ åƒã€ç«‹ä½“éŸ³éŸ¿ã€å¾®ç´°ãªæŒ¯å‹•ã«ã‚ˆã‚‹è§¦è¦šãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ©Ÿèƒ½ã‚’æ­è¼‰ã—ãŸå°‚ç”¨ãƒ˜ãƒƒãƒ‰ã‚»ãƒƒãƒˆã€‚ä»–ã®è¦–è´è€…ã¨ã‚¢ãƒã‚¿ãƒ¼ã§äº¤æµã§ãã‚‹ã‚½ãƒ¼ã‚·ãƒ£ãƒ«æ©Ÿèƒ½ã‚‚å‚™ãˆã‚‹ã€‚', metrics: 'å¯¾å¿œã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è²©å£²æ•°ã€å¹³å‡è¦–è´æ™‚é–“', tech: 'æ˜ åƒãƒ»éŸ³éŸ¿æŠ€è¡“ã€é«˜é€Ÿãƒ»ä½é…å»¶é€šä¿¡æŠ€è¡“ã€å°å‹åŒ–æŠ€è¡“', score_market: 3, score_profit: 3, score_sony: 5, score_feasibility: 3, score_validation: 2, score_timing: 5 }
        };

        const criteriaData = `
            <div class="space-y-4 text-sm">
                <div class="bg-white p-4 rounded-lg shadow-sm border border-slate-200"><h4 class="font-bold text-base text-slate-800">å¸‚å ´æ€§</h4><p class="text-slate-600 mt-2"><strong class="w-12 inline-block">[5ç‚¹]</strong> æ—¢å­˜å¸‚å ´ã‚’ç ´å£Šã€ã¾ãŸã¯å·¨å¤§ãªæ–°å¸‚å ´ã‚’å‰µé€ ã™ã‚‹å¯èƒ½æ€§</p><p class="text-slate-600 mt-1"><strong class="w-12 inline-block">[3ç‚¹]</strong> ç‰¹å®šã®ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã§é«˜ã„ã‚·ã‚§ã‚¢ã‚’ç‹™ãˆã‚‹</p><p class="text-slate-600 mt-1"><strong class="w-12 inline-block">[1ç‚¹]</strong> ãƒ‹ãƒƒãƒå¸‚å ´ã§ã€å¤§ããªæˆé•·ã¯è¦‹è¾¼ã¿ã«ãã„</p></div>
                <div class="bg-white p-4 rounded-lg shadow-sm border border-slate-200"><h4 class="font-bold text-base text-slate-800">åç›Šæ€§</h4><p class="text-slate-600 mt-2"><strong class="w-12 inline-block">[5ç‚¹]</strong> é«˜ã„åˆ©ç›Šç‡ãŒè¦‹è¾¼ã‚ã€ç¶™ç¶šçš„ãªåç›Šãƒ¢ãƒ‡ãƒ«ï¼ˆã‚µãƒ–ã‚¹ã‚¯ç­‰ï¼‰ã‚’æ§‹ç¯‰å¯èƒ½</p><p class="text-slate-600 mt-1"><strong class="w-12 inline-block">[3ç‚¹]</strong> å£²ã‚Šåˆ‡ã‚Šãƒ¢ãƒ‡ãƒ«ã ãŒã€ååˆ†ãªåˆ©ç›ŠãŒè¦‹è¾¼ã‚ã‚‹</p><p class="text-slate-600 mt-1"><strong class="w-12 inline-block">[1ç‚¹]</strong> ãƒãƒã‚¿ã‚¤ã‚ºã®å…·ä½“æ¡ˆãŒä¸æ˜ç¢ºã€ã¾ãŸã¯ä½åˆ©ç›Šç‡</p></div>
                <div class="bg-white p-4 rounded-lg shadow-sm border border-slate-200"><h4 class="font-bold text-base text-slate-800">ã‚½ãƒ‹ãƒ¼ã‚‰ã—ã•</h4><p class="text-slate-600 mt-2"><strong class="w-12 inline-block">[5ç‚¹]</strong> æŠ€è¡“ãƒ»ãƒ–ãƒ©ãƒ³ãƒ‰ãƒ»é¡§å®¢åŸºç›¤ãªã©ã€è‡ªç¤¾ã®å¼·ã¿ã‚’æœ€å¤§é™ã«æ´»ã‹ã›ã‚‹</p><p class="text-slate-600 mt-1"><strong class="w-12 inline-block">[3ç‚¹]</strong> è‡ªç¤¾ã®æ—¢å­˜äº‹æ¥­ã¨ã‚·ãƒŠã‚¸ãƒ¼ãŒã‚ã‚‹</p><p class="text-slate-600 mt-1"><strong class="w-12 inline-block">[1ç‚¹]</strong> è‡ªç¤¾ã§ã‚„ã‚‹å¿…ç„¶æ€§ãŒä½ã„</p></div>
                <div class="bg-white p-4 rounded-lg shadow-sm border border-slate-200"><h4 class="font-bold text-base text-slate-800">æŠ€è¡“çš„å®Ÿç¾æ€§</h4><p class="text-slate-600 mt-2"><strong class="w-12 inline-block">[5ç‚¹]</strong> æ—¢å­˜æŠ€è¡“ã®å¿œç”¨ã§å®Ÿç¾å¯èƒ½ã€‚ãƒªã‚¹ã‚¯ã¯ä½ã„</p><p class="text-slate-600 mt-1"><strong class="w-12 inline-block">[3ç‚¹]</strong> ã„ãã¤ã‹æŠ€è¡“çš„èª²é¡Œã¯ã‚ã‚‹ãŒã€1-2å¹´ã§è§£æ±ºå¯èƒ½</p><p class="text-slate-600 mt-1"><strong class="w-12 inline-block">[1ç‚¹]</strong> æœªçŸ¥ã®æŠ€è¡“è¦ç´ ãŒå¤šãã€å®Ÿç¾ã«ã¯ãƒ–ãƒ¬ãƒ¼ã‚¯ã‚¹ãƒ«ãƒ¼ãŒå¿…è¦</p></div>
            </div>`;
        criteriaSection.innerHTML = criteriaData;

        // --- Tab Logic ---
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                tabs.forEach(t => t.classList.remove('active'));
                contents.forEach(c => c.classList.remove('active'));
                tab.classList.add('active');
                document.getElementById(tab.dataset.tab).classList.add('active');
            });
        });

        // --- Data Handling ---
        function collectDataFromDOM() {
            const data = {};
            const ideaElements = ideasSection.querySelectorAll('[data-id]');
            ideaElements.forEach(el => {
                const id = el.dataset.id;
                if (!data[id]) data[id] = { id: id };
                el.querySelectorAll('[data-field]').forEach(fieldEl => {
                    data[id][fieldEl.dataset.field] = fieldEl.textContent.trim();
                });
            });
            const scoringElements = scoringTbody.querySelectorAll('[data-id]');
            scoringElements.forEach(el => {
                const id = el.dataset.id;
                if (!data[id]) data[id] = { id: id };
                el.querySelectorAll('[data-field]').forEach(fieldEl => {
                    data[id][fieldEl.dataset.field] = fieldEl.textContent.trim();
                });
            });
            return data;
        }
        
        function renderData(data) {
            ideasSection.innerHTML = '';
            scoringTbody.innerHTML = '';
            const sortedIds = Object.keys(data).sort();

            sortedIds.forEach(id => {
                const item = data[id];
                const ideaHtml = `
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200" data-id="${item.id}">
                        <h3 class="text-lg font-bold" contenteditable="true" data-field="name">${item.name || ''}</h3>
                        <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4 text-sm">
                            <div><strong class="text-slate-600">ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé¡§å®¢:</strong> <span contenteditable="true" data-field="target">${item.target || ''}</span></div>
                            <div><strong class="text-slate-600">æ ¹æ·±ã„èª²é¡Œ:</strong> <span contenteditable="true" data-field="problem">${item.problem || ''}</span></div>
                            <div class="md:col-span-2"><strong class="text-slate-600">ç‹¬è‡ªã®ä¾¡å€¤ææ¡ˆ(UVP):</strong> <span contenteditable="true" data-field="uvp">${item.uvp || ''}</span></div>
                            <div class="md:col-span-2"><strong class="text-slate-600">å…·ä½“çš„ãªã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³:</strong> <span contenteditable="true" data-field="solution">${item.solution || ''}</span></div>
                            <div><strong class="text-slate-600">ä¸»è¦æŒ‡æ¨™:</strong> <span contenteditable="true" data-field="metrics">${item.metrics || ''}</span></div>
                            <div><strong class="text-slate-600">æŠ€è¡“çš„å„ªä½æ€§:</strong> <span contenteditable="true" data-field="tech">${item.tech || ''}</span></div>
                        </div>
                    </div>`;
                ideasSection.insertAdjacentHTML('beforeend', ideaHtml);

                const scoreHtml = `
                    <tr class="border-b border-slate-200 border-l-8" data-id="${item.id}">
                        <td data-label="No" class="p-4 font-medium">${item.id}</td>
                        <td data-label="ã‚¢ã‚¤ãƒ‡ã‚¢å" class="p-4 font-medium" contenteditable="true" data-field="name">${item.name || ''}</td>
                        <td data-label="å¸‚å ´æ€§" class="p-4" contenteditable="true" data-field="score_market">${item.score_market || 0}</td>
                        <td data-label="åç›Šæ€§" class="p-4" contenteditable="true" data-field="score_profit">${item.score_profit || 0}</td>
                        <td data-label="ã‚½ãƒ‹ãƒ¼ã‚‰ã—ã•" class="p-4" contenteditable="true" data-field="score_sony">${item.score_sony || 0}</td>
                        <td data-label="æŠ€è¡“å®Ÿç¾æ€§" class="p-4" contenteditable="true" data-field="score_feasibility">${item.score_feasibility || 0}</td>
                        <td data-label="ä»®èª¬æ¤œè¨¼å®¹æ˜“ã•" class="p-4" contenteditable="true" data-field="score_validation">${item.score_validation || 0}</td>
                        <td data-label="Why Now" class="p-4" contenteditable="true" data-field="score_timing">${item.score_timing || 0}</td>
                        <td data-label="åˆè¨ˆç‚¹" class="p-4 font-bold text-lg" data-field="total">0</td>
                        <td data-label="é †ä½" class="p-4 font-bold text-lg" data-field="rank">0</td>
                    </tr>`;
                scoringTbody.insertAdjacentHTML('beforeend', scoreHtml);
            });
            updateScoresAndRanks();
            syncNames();
        }

        function updateScoresAndRanks() {
            let scores = [];
            scoringTbody.querySelectorAll('tr').forEach(row => {
                const total = Array.from(row.querySelectorAll('[data-field^="score_"]'))
                                   .reduce((sum, cell) => sum + (parseInt(cell.textContent, 10) || 0), 0);
                row.querySelector('[data-field="total"]').textContent = total;
                scores.push({ id: row.dataset.id, total: total, row: row });
            });

            scores.sort((a, b) => b.total - a.total);
            
            const rankClasses = ['rank-gold', 'rank-silver', 'rank-bronze'];
            scores.forEach((score, index) => {
                const rankCell = score.row.querySelector('[data-field="rank"]');
                rankCell.textContent = index + 1;
                
                score.row.classList.remove(...rankClasses);
                rankCell.classList.remove('text-amber-500', 'text-slate-500', 'text-orange-700');

                if (index === 0) { score.row.classList.add('rank-gold'); rankCell.classList.add('text-amber-500'); }
                else if (index === 1) { score.row.classList.add('rank-silver'); rankCell.classList.add('text-slate-500'); }
                else if (index === 2) { score.row.classList.add('rank-bronze'); rankCell.classList.add('text-orange-700'); }
            });
        }

        function syncNames() {
            document.querySelectorAll('[contenteditable="true"][data-field="name"]').forEach(nameField => {
                nameField.addEventListener('input', (e) => {
                    const id = e.target.closest('[data-id]').dataset.id;
                    const newName = e.target.textContent;
                    document.querySelectorAll(`[data-id="${id}"] [data-field="name"]`).forEach(field => {
                        if (field !== e.target) {
                            field.textContent = newName;
                        }
                    });
                });
            });
        }
        
        function saveData() {
            const dataToSave = collectDataFromDOM();
            localStorage.setItem(storageKey, JSON.stringify(dataToSave));
            saveStatus.textContent = `âœ… ${new Date().toLocaleTimeString()} ã«ä¿å­˜ã—ã¾ã—ãŸ`;
            setTimeout(() => saveStatus.textContent = '', 2000);
        }

        function loadData() {
            const savedData = localStorage.getItem(storageKey);
            const data = savedData ? JSON.parse(savedData) : initialData;
            renderData(data);
        }

        // --- Event Listeners ---
        saveDataBtn.addEventListener('click', saveData);
        resetDataBtn.addEventListener('click', () => {
            if (confirm('æœ¬å½“ã«åˆæœŸãƒ‡ãƒ¼ã‚¿ã«æˆ»ã—ã¾ã™ã‹ï¼Ÿç·¨é›†ä¸­ã®å†…å®¹ã¯å¤±ã‚ã‚Œã¾ã™ã€‚')) {
                localStorage.removeItem(storageKey);
                loadData();
            }
        });
        
        addIdeaBtn.addEventListener('click', () => {
            const allIds = Array.from(ideasSection.querySelectorAll('[data-id]')).map(el => el.dataset.id);
            const nextChar = String.fromCharCode(Math.max(...allIds.map(id => id.charCodeAt(0)), 64) + 1);
            
            const newItem = { id: nextChar, name: `${nextChar}. æ–°ã—ã„ã‚¢ã‚¤ãƒ‡ã‚¢`, target: '', problem: '', uvp: '', solution: '', metrics: '', tech: '', score_market: 0, score_profit: 0, score_sony: 0, score_feasibility: 0, score_validation: 0, score_timing: 0 };
            
            let currentData = collectDataFromDOM();
            currentData[nextChar] = newItem;
            renderData(currentData);
        });

        document.querySelector('#scoring tbody').addEventListener('input', (e) => {
             if(e.target.matches('[data-field^="score_"]')) {
                updateScoresAndRanks();
             }
        });

        // --- Initial Load ---
        loadData();
    });
    </script>
</body>
</html>
