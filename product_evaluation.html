<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>【編集可能】プロダクトアイデア評価シート</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
        }
        .tab-btn.active {
            border-color: #3b82f6;
            background-color: #3b82f6;
            color: white;
        }
        .content-box { display: none; }
        .content-box.active { display: block; }
        [contenteditable="true"] {
            outline: 2px solid transparent;
            transition: outline 0.2s;
            padding: 2px 4px;
            border-radius: 4px;
        }
        [contenteditable="true"]:hover {
            background-color: #eff6ff;
        }
        [contenteditable="true"]:focus {
            outline: 2px solid #3b82f6;
            background-color: white;
            box-shadow: 0 0 0 2px #bfdbfe;
        }
        @media (max-width: 768px) {
            .responsive-table thead { display: none; }
            .responsive-table, .responsive-table tbody, .responsive-table tr, .responsive-table td {
                display: block;
                width: 100%;
            }
            .responsive-table tr {
                margin-bottom: 1.5rem;
                border: 1px solid #e5e7eb;
                border-radius: 0.5rem;
                padding: 1rem;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
            .responsive-table td {
                padding-left: 50%;
                position: relative;
                text-align: right;
                border: none;
            }
            .responsive-table td::before {
                content: attr(data-label);
                position: absolute;
                left: 0.75rem;
                width: 45%;
                padding-right: 0.75rem;
                text-align: left;
                font-weight: 600;
                color: #1f2937;
            }
        }
        .rank-gold { background-color: #fffbeb; border-left-color: #f59e0b; }
        .rank-silver { background-color: #f9fafb; border-left-color: #9ca3af; }
        .rank-bronze { background-color: #fdf2f2; border-left-color: #cd7f32; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div class="container mx-auto p-4 sm:p-6 md:p-8">
        <header class="text-center mb-6">
            <h1 class="text-3xl md:text-4xl font-bold text-slate-900">プロダクトアイデア評価シート</h1>
            <p class="mt-2 text-slate-600">アイデア名や点数をクリックして直接編集できます。</p>
        </header>

        <div class="bg-white p-4 rounded-lg shadow-sm border border-slate-200 mb-6 flex flex-col sm:flex-row justify-center items-center gap-4">
            <button id="save-data" class="w-full sm:w-auto bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition">
                ✔️ 編集を保存
            </button>
            <button id="reset-data" class="w-full sm:w-auto bg-slate-200 text-slate-700 font-bold py-2 px-6 rounded-lg hover:bg-slate-300 transition">
                🔄 初期データに戻す
            </button>
            <span id="save-status" class="text-sm text-slate-500 h-4"></span>
        </div>

        <nav class="flex justify-center border-b border-slate-200 mb-8">
            <button class="tab-btn active text-lg font-semibold py-3 px-6 border-b-4" data-tab="ideas">アイデア一覧</button>
            <button class="tab-btn text-lg font-semibold py-3 px-6 border-b-4 border-transparent text-slate-500 hover:border-slate-300" data-tab="scoring">採点表</button>
            <button class="tab-btn text-lg font-semibold py-3 px-6 border-b-4 border-transparent text-slate-500 hover:border-slate-300" data-tab="criteria">採点基準</button>
        </nav>

        <main id="data-container">
            <section id="ideas" class="content-box active space-y-6">
                </section>
            <section id="scoring" class="content-box">
                 <div class="overflow-x-auto bg-white rounded-lg shadow-sm border border-slate-200">
                    <table class="responsive-table w-full text-sm text-left">
                        <thead class="bg-slate-100 text-slate-600 uppercase">
                            <tr>
                                <th class="p-4">No</th><th class="p-4">アイデア名</th><th class="p-4">市場性</th><th class="p-4">収益性</th><th class="p-4">ソニーらしさ</th><th class="p-4">技術実現性</th><th class="p-4">仮説検証容易さ</th><th class="p-4">Why Now</th><th class="p-4 font-bold">合計点</th><th class="p-4 font-bold">順位</th>
                            </tr>
                        </thead>
                        <tbody>
                            </tbody>
                    </table>
                </div>
            </section>
            <section id="criteria" class="content-box">
                </section>
        </main>
        
        <div class="mt-8 flex justify-center">
            <button id="add-idea" class="bg-green-500 text-white font-bold py-3 px-8 rounded-lg hover:bg-green-600 transition shadow">
                ＋ 新しいアイデアを追加
            </button>
        </div>

        <footer class="mt-8 text-center text-sm text-slate-500">
             <a href="index.html" class="text-blue-600 hover:underline">← メインページに戻る</a>
        </footer>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const tabs = document.querySelectorAll('.tab-btn');
        const contents = document.querySelectorAll('.content-box');
        const saveDataBtn = document.getElementById('save-data');
        const resetDataBtn = document.getElementById('reset-data');
        const addIdeaBtn = document.getElementById('add-idea');
        const saveStatus = document.getElementById('save-status');
        const ideasSection = document.getElementById('ideas');
        const scoringTbody = document.querySelector('#scoring tbody');
        const criteriaSection = document.getElementById('criteria');
        const storageKey = 'productEvaluationData';

        const initialData = {
            // This is the initial data. It will be used if there's nothing in localStorage.
            // In the final version, this will be replaced with your data from the CSV.
            'A': { id: 'A', name: 'A. 画面タッチで音楽を奏でるデバイス', target: '音楽経験はないが、手軽に自己表現をしたい若者', problem: '楽器演奏は習得が難しく、作曲は専門知識が必要でハードルが高い', uvp: '楽譜も経験も不要。触れるだけで、プロが作ったような音楽を直感的に生み出せる魔法のキャンバス', solution: '画面をタッチする場所や指の動きで音色やリズムが変化するパッド型デバイス。AIがユーザーの操作を解析し、音楽的に破綻しないようリアルタイムでアシストする。', metrics: '1日あたりの平均演奏時間、SNSでの作品シェア数', tech: '触覚フィードバック技術、音源合成技術、AIによる音楽生成アルゴリズム', score_market: 4, score_profit: 4, score_sony: 5, score_feasibility: 4, score_validation: 5, score_timing: 5 },
            'B': { id: 'B', name: 'B. 子供の成長を記録し、才能を予測するAIカメラ', target: '子供の将来や教育に関心が高い30-40代の親', problem: '子供の何気ない日常の行動にどんな才能が隠れているか分からず、教育方針に迷う', uvp: '日常を撮るだけで、AIが我が子の「隠れた得意」を見つけ出し、未来の可能性を教えてくれる子育てパートナー', solution: '子供の行動（ブロック遊び、絵描き、運動など）を定点カメラで撮影。AIが画像解析で行動パターンを分類・分析し、「空間認識能力が高い」「集中力が持続する」などの特性を可視化し、レポートする。', metrics: '保護者のアプリ継続利用率、有料レポートの購入率', tech: '高度な画像認識・行動分析AI、教育心理学に基づいた分析モデル', score_market: 5, score_profit: 3, score_sony: 4, score_feasibility: 4, score_validation: 3, score_timing: 4 },
            'C': { id: 'C', name: 'C. 没入感を究極に高めるVRライブ用ヘッドセット', target: '遠方に住んでいる、またはチケットが入手困難でライブに行けない音楽ファン', problem: 'ライブ配信は便利だが、会場の熱気や一体感がなく物足りない', uvp: '自宅が最前列アリーナに変わる。アーティストの息遣いと会場の熱狂を全身で感じる、究極の没入型ライブ体験', solution: '8K超高解像度映像、立体音響、微細な振動による触覚フィードバック機能を搭載した専用ヘッドセット。他の視聴者とアバターで交流できるソーシャル機能も備える。', metrics: '対応コンテンツの販売数、平均視聴時間', tech: '映像・音響技術、高速・低遅延通信技術、小型化技術', score_market: 3, score_profit: 3, score_sony: 5, score_feasibility: 3, score_validation: 2, score_timing: 5 }
        };

        const criteriaData = `
            <div class="space-y-4 text-sm">
                <div class="bg-white p-4 rounded-lg shadow-sm border border-slate-200"><h4 class="font-bold text-base text-slate-800">市場性</h4><p class="text-slate-600 mt-2"><strong class="w-12 inline-block">[5点]</strong> 既存市場を破壊、または巨大な新市場を創造する可能性</p><p class="text-slate-600 mt-1"><strong class="w-12 inline-block">[3点]</strong> 特定のセグメントで高いシェアを狙える</p><p class="text-slate-600 mt-1"><strong class="w-12 inline-block">[1点]</strong> ニッチ市場で、大きな成長は見込みにくい</p></div>
                <div class="bg-white p-4 rounded-lg shadow-sm border border-slate-200"><h4 class="font-bold text-base text-slate-800">収益性</h4><p class="text-slate-600 mt-2"><strong class="w-12 inline-block">[5点]</strong> 高い利益率が見込め、継続的な収益モデル（サブスク等）を構築可能</p><p class="text-slate-600 mt-1"><strong class="w-12 inline-block">[3点]</strong> 売り切りモデルだが、十分な利益が見込める</p><p class="text-slate-600 mt-1"><strong class="w-12 inline-block">[1点]</strong> マネタイズの具体案が不明確、または低利益率</p></div>
                <div class="bg-white p-4 rounded-lg shadow-sm border border-slate-200"><h4 class="font-bold text-base text-slate-800">ソニーらしさ</h4><p class="text-slate-600 mt-2"><strong class="w-12 inline-block">[5点]</strong> 技術・ブランド・顧客基盤など、自社の強みを最大限に活かせる</p><p class="text-slate-600 mt-1"><strong class="w-12 inline-block">[3点]</strong> 自社の既存事業とシナジーがある</p><p class="text-slate-600 mt-1"><strong class="w-12 inline-block">[1点]</strong> 自社でやる必然性が低い</p></div>
                <div class="bg-white p-4 rounded-lg shadow-sm border border-slate-200"><h4 class="font-bold text-base text-slate-800">技術的実現性</h4><p class="text-slate-600 mt-2"><strong class="w-12 inline-block">[5点]</strong> 既存技術の応用で実現可能。リスクは低い</p><p class="text-slate-600 mt-1"><strong class="w-12 inline-block">[3点]</strong> いくつか技術的課題はあるが、1-2年で解決可能</p><p class="text-slate-600 mt-1"><strong class="w-12 inline-block">[1点]</strong> 未知の技術要素が多く、実現にはブレークスルーが必要</p></div>
            </div>`;
        criteriaSection.innerHTML = criteriaData;

        // --- Tab Logic ---
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                tabs.forEach(t => t.classList.remove('active'));
                contents.forEach(c => c.classList.remove('active'));
                tab.classList.add('active');
                document.getElementById(tab.dataset.tab).classList.add('active');
            });
        });

        // --- Data Handling ---
        function collectDataFromDOM() {
            const data = {};
            const ideaElements = ideasSection.querySelectorAll('[data-id]');
            ideaElements.forEach(el => {
                const id = el.dataset.id;
                if (!data[id]) data[id] = { id: id };
                el.querySelectorAll('[data-field]').forEach(fieldEl => {
                    data[id][fieldEl.dataset.field] = fieldEl.textContent.trim();
                });
            });
            const scoringElements = scoringTbody.querySelectorAll('[data-id]');
            scoringElements.forEach(el => {
                const id = el.dataset.id;
                if (!data[id]) data[id] = { id: id };
                el.querySelectorAll('[data-field]').forEach(fieldEl => {
                    data[id][fieldEl.dataset.field] = fieldEl.textContent.trim();
                });
            });
            return data;
        }
        
        function renderData(data) {
            ideasSection.innerHTML = '';
            scoringTbody.innerHTML = '';
            const sortedIds = Object.keys(data).sort();

            sortedIds.forEach(id => {
                const item = data[id];
                const ideaHtml = `
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200" data-id="${item.id}">
                        <h3 class="text-lg font-bold" contenteditable="true" data-field="name">${item.name || ''}</h3>
                        <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4 text-sm">
                            <div><strong class="text-slate-600">ターゲット顧客:</strong> <span contenteditable="true" data-field="target">${item.target || ''}</span></div>
                            <div><strong class="text-slate-600">根深い課題:</strong> <span contenteditable="true" data-field="problem">${item.problem || ''}</span></div>
                            <div class="md:col-span-2"><strong class="text-slate-600">独自の価値提案(UVP):</strong> <span contenteditable="true" data-field="uvp">${item.uvp || ''}</span></div>
                            <div class="md:col-span-2"><strong class="text-slate-600">具体的なソリューション:</strong> <span contenteditable="true" data-field="solution">${item.solution || ''}</span></div>
                            <div><strong class="text-slate-600">主要指標:</strong> <span contenteditable="true" data-field="metrics">${item.metrics || ''}</span></div>
                            <div><strong class="text-slate-600">技術的優位性:</strong> <span contenteditable="true" data-field="tech">${item.tech || ''}</span></div>
                        </div>
                    </div>`;
                ideasSection.insertAdjacentHTML('beforeend', ideaHtml);

                const scoreHtml = `
                    <tr class="border-b border-slate-200 border-l-8" data-id="${item.id}">
                        <td data-label="No" class="p-4 font-medium">${item.id}</td>
                        <td data-label="アイデア名" class="p-4 font-medium" contenteditable="true" data-field="name">${item.name || ''}</td>
                        <td data-label="市場性" class="p-4" contenteditable="true" data-field="score_market">${item.score_market || 0}</td>
                        <td data-label="収益性" class="p-4" contenteditable="true" data-field="score_profit">${item.score_profit || 0}</td>
                        <td data-label="ソニーらしさ" class="p-4" contenteditable="true" data-field="score_sony">${item.score_sony || 0}</td>
                        <td data-label="技術実現性" class="p-4" contenteditable="true" data-field="score_feasibility">${item.score_feasibility || 0}</td>
                        <td data-label="仮説検証容易さ" class="p-4" contenteditable="true" data-field="score_validation">${item.score_validation || 0}</td>
                        <td data-label="Why Now" class="p-4" contenteditable="true" data-field="score_timing">${item.score_timing || 0}</td>
                        <td data-label="合計点" class="p-4 font-bold text-lg" data-field="total">0</td>
                        <td data-label="順位" class="p-4 font-bold text-lg" data-field="rank">0</td>
                    </tr>`;
                scoringTbody.insertAdjacentHTML('beforeend', scoreHtml);
            });
            updateScoresAndRanks();
            syncNames();
        }

        function updateScoresAndRanks() {
            let scores = [];
            scoringTbody.querySelectorAll('tr').forEach(row => {
                const total = Array.from(row.querySelectorAll('[data-field^="score_"]'))
                                   .reduce((sum, cell) => sum + (parseInt(cell.textContent, 10) || 0), 0);
                row.querySelector('[data-field="total"]').textContent = total;
                scores.push({ id: row.dataset.id, total: total, row: row });
            });

            scores.sort((a, b) => b.total - a.total);
            
            const rankClasses = ['rank-gold', 'rank-silver', 'rank-bronze'];
            scores.forEach((score, index) => {
                const rankCell = score.row.querySelector('[data-field="rank"]');
                rankCell.textContent = index + 1;
                
                score.row.classList.remove(...rankClasses);
                rankCell.classList.remove('text-amber-500', 'text-slate-500', 'text-orange-700');

                if (index === 0) { score.row.classList.add('rank-gold'); rankCell.classList.add('text-amber-500'); }
                else if (index === 1) { score.row.classList.add('rank-silver'); rankCell.classList.add('text-slate-500'); }
                else if (index === 2) { score.row.classList.add('rank-bronze'); rankCell.classList.add('text-orange-700'); }
            });
        }

        function syncNames() {
            document.querySelectorAll('[contenteditable="true"][data-field="name"]').forEach(nameField => {
                nameField.addEventListener('input', (e) => {
                    const id = e.target.closest('[data-id]').dataset.id;
                    const newName = e.target.textContent;
                    document.querySelectorAll(`[data-id="${id}"] [data-field="name"]`).forEach(field => {
                        if (field !== e.target) {
                            field.textContent = newName;
                        }
                    });
                });
            });
        }
        
        function saveData() {
            const dataToSave = collectDataFromDOM();
            localStorage.setItem(storageKey, JSON.stringify(dataToSave));
            saveStatus.textContent = `✅ ${new Date().toLocaleTimeString()} に保存しました`;
            setTimeout(() => saveStatus.textContent = '', 2000);
        }

        function loadData() {
            const savedData = localStorage.getItem(storageKey);
            const data = savedData ? JSON.parse(savedData) : initialData;
            renderData(data);
        }

        // --- Event Listeners ---
        saveDataBtn.addEventListener('click', saveData);
        resetDataBtn.addEventListener('click', () => {
            if (confirm('本当に初期データに戻しますか？編集中の内容は失われます。')) {
                localStorage.removeItem(storageKey);
                loadData();
            }
        });
        
        addIdeaBtn.addEventListener('click', () => {
            const allIds = Array.from(ideasSection.querySelectorAll('[data-id]')).map(el => el.dataset.id);
            const nextChar = String.fromCharCode(Math.max(...allIds.map(id => id.charCodeAt(0)), 64) + 1);
            
            const newItem = { id: nextChar, name: `${nextChar}. 新しいアイデア`, target: '', problem: '', uvp: '', solution: '', metrics: '', tech: '', score_market: 0, score_profit: 0, score_sony: 0, score_feasibility: 0, score_validation: 0, score_timing: 0 };
            
            let currentData = collectDataFromDOM();
            currentData[nextChar] = newItem;
            renderData(currentData);
        });

        document.querySelector('#scoring tbody').addEventListener('input', (e) => {
             if(e.target.matches('[data-field^="score_"]')) {
                updateScoresAndRanks();
             }
        });

        // --- Initial Load ---
        loadData();
    });
    </script>
</body>
</html>
